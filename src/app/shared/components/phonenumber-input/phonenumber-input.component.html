<!-- phonenumber-input.component.html -->
<div class="relative flex items-center">
  <!-- Sélecteur de pays -->
  <div class="relative text-gray-800">
    <div 
      (click)="toggleCountrySelect()"
      class="flex items-center cursor-pointer h-12 p-2 bg-transparent w-full text-white placeholder-gray-400 border-0 border-b-2 border-white pb-2 focus:outline-none focus:ring-0 focus:border-green-500 transition-colors"
      [class.opacity-50]="disabled"
      [class.cursor-not-allowed]="disabled"
      [class.border-green-500]="isValid && phoneNumber"
      [ngClass]="{'!border-red-500': !isValid && touched, 'focus:ring-red-500': !isValid && phoneNumber, '!focus:border-red-500': !isValid && phoneNumber}"
    >
      <img title="{{selectedCountry.code}}" [src]="selectedCountry.flag" class="w-6 h-4 mr-2" [alt]="selectedCountry.name">
      <span class="text-sm font-medium">{{ selectedCountry.dialCode }}</span>
      <svg class="w-4 h-4 ml-1 text-gray-500 transition-transform" 
           [class.rotate-180]="isCountrySelectOpen"
           fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </div>

    <!-- Liste des pays -->
    <div 
      *ngIf="isCountrySelectOpen && !disabled"
      class="absolute z-10 mt-1 w-64 bg-gray-200 border-none rounded-lg shadow-lg max-h-60 overflow-y-auto"
    >
      <div 
        *ngFor="let country of countries"
        (click)="selectCountry(country, $event)"
        class="flex items-center p-3 hover:bg-primary cursor-pointer transition-colors"
        [class.bg-primary]="country.code === selectedCountry.code"
      >
        <img title="{{country.code}}" [src]="country.flag" class="w-6 h-4 mr-3" [alt]="country.name">
        <div class="flex-grow">
          <div class="text-sm font-medium">{{ country.name }}</div>
          <div class="text-xs text-gray-500">{{ country.dialCode }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Champ de saisie -->
  <div class="relative flex-grow">
    <input
      type="tel"
      [value]="displayPhoneNumber"
      (input)="onPhoneNumberInput($event)"
      (blur)="onInputBlur()"
      [placeholder]="getExampleNumber()"
      [disabled]="disabled"
      class="w-full p-3 h-12 bg-transparent text-white placeholder-gray-400 border-0 border-b-2 border-white pb-2 focus:outline-none focus:ring-0 focus:border-white transition-colors"
      [class.border-red-500]="!isValid"
      [ngClass]="{'!border-red-500': !isValid && touched, 'focus:ring-red-500': !isValid && phoneNumber, '!focus:border-red-500': !isValid && phoneNumber}"
      [class.border-green-500]="isValid && phoneNumber"
    >
    
    <!-- Indicateur de validation -->
    <div class="absolute right-3 top-1/2 transform -translate-y-1/2" *ngIf="phoneNumber">
      <svg *ngIf="isValid" class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      <svg *ngIf="!isValid" class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </div>
  </div>
</div>

<!-- Message de validation optionnel -->
<div *ngIf="phoneNumber && !isValid" class="mt-1 text-sm text-red-600">
  Numéro de téléphone invalide
</div>
<!-- <div *ngIf="phoneNumber && isValid" class="mt-1 text-sm text-green-600">
  Format: {{ formattedFullPhoneNumber }}
</div> -->